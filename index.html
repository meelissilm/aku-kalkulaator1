<!DOCTYPE html>
<html lang="et">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aku kalkulaator</title>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; background: #f4f4f9; }
  h1 { color: #333; }
  label { display: block; margin-top: 15px; }
  input { padding: 6px; margin-top: 5px; width: 200px; }
  button { margin-top: 20px; padding: 10px 20px; background: #007BFF; color: white; border: none; border-radius: 5px; }
  button:hover { background: #0056b3; cursor: pointer; }
  #result { margin-top: 20px; padding: 10px; background: #fff; border-radius: 5px; }

  #viewcounter {
    position: fixed;
    bottom: 10px;
    right: 10px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 14px;
    z-index: 1000;
  }

  #datetime {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 14px;
    text-align: center;
    z-index: 1000;
  }
</style>
</head>
<body>

<h1>Aku kestvuse kalkulaator</h1>

<label>Normaalne tarbimine (mA):
  <input type="number" id="inValue" placeholder="nt 400">
</label>
<label>Häire tarbimine (mA):
  <input type="number" id="ihValue" placeholder="nt 1000">
</label>
<label>Normaalaeg (tundi):
  <input type="number" id="timeNorm" placeholder="nt 72">
</label>
<label>Häireaeg (tundi):
  <input type="number" id="timeAlarm" placeholder="nt 0.5">
</label>
<label>Akumahtuvus (Ah):
  <input type="number" id="capacity" placeholder="nt 17">
</label>
<button onclick="calculate()">Arvuta</button>

<div id="result"></div>

<div id="viewcounter">Lehte on vaadatud: <span id="viewcount">0</span> korda</div>
<div id="datetime"></div>

<script>
  function calculate() {
    const IN = parseFloat(document.getElementById('inValue').value) || 0;
    const IH = parseFloat(document.getElementById('ihValue').value) || 0;
    const timeN = parseFloat(document.getElementById('timeNorm').value) || 0;
    const timeA = parseFloat(document.getElementById('timeAlarm').value) || 0;
    const cap = parseFloat(document.getElementById('capacity').value) || 0;

    if (IN < 0 || IH < 0 || timeN < 0 || timeA < 0 || cap < 0) {
      document.getElementById('result').innerHTML =
        "<span style='color:red'>Sisendväärtused peavad olema positiivsed!</span>";
      return;
    }

    const needAh = (IN/1000 * timeN) + (IH/1000 * timeA);
    let resultText = "<b>Nõutav mahtuvus:</b> " + needAh.toFixed(2) + " Ah<br>";

    if (cap > 0 && (timeN+timeA) > 0) {
      const totalCurrent = needAh;
      const avgCurrent = totalCurrent / (timeN + timeA);
      const runtime = cap / avgCurrent;
      resultText += "<b>Valitud aku kestvus:</b> " + runtime.toFixed(1) + " h (ligikaudne)";
    }
    document.getElementById('result').innerHTML = resultText;
  }

  // Loendur (LocalStorage)
  let views = localStorage.getItem("page_views");
  if (!views) {
    views = 0;
  }
  views++;
  localStorage.setItem("page_views", views);
  document.getElementById("viewcount").textContent = views;

  // Kellaaeg ja kuupäev
  function updateDateTime() {
    const now = new Date();
    const time = now.toLocaleTimeString('et-EE', {hour12: false});
    const date = now.toLocaleDateString('et-EE');
    document.getElementById('datetime').innerHTML = time + "<br>" + date;
  }
  updateDateTime();
  setInterval(updateDateTime, 1000);
</script>

</body>
</html>
